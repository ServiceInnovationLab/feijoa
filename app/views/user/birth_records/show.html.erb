<div class="mb-4">
  <%= link_to "← Back", user_birth_records_path(@user), class: 'text-dark' %>
</div>
<div class="card mb-4 p-4 birth-record" data-id="<%= @birth_record.to_param %>">
  <div class="card-body">
    <div class="d-flex justify-content-between mb-4">
      <h1 class="card-title">Birth Record</h1>
      <div>
        <%= link_to 'Remove', remove_user_birth_record_path(@birth_record), class: 'btn btn-danger', data: { confirm: 'Are you sure? This will remove the record from your documents'}, method: :post %>
      </div>
    </div>
    <h5>
      <strong><%= @birth_record.family_name %></strong>,
      <%= @birth_record.first_and_middle_names %>
    </h5>
    <dl>
      <dt>Date of birth</dt>
      <dd><%= @birth_record.date_of_birth %></dd>
      <dt>Place of birth</dt>
      <dd><%= @birth_record.place_of_birth %></dd>
      <dt>Sex</dt>
      <dd><%=@birth_record.sex %></dd>
      <dt>Parent 1</dt>
      <dd><%=@birth_record.parent_family_name %>, <%=@birth_record.parent_first_and_middle_names %></dd>
      <dt>Parent 2</dt>
      <dd><%=@birth_record.other_parent_family_name %>, <%=@birth_record.other_parent_first_and_middle_names %></dd>
    </dl>
  </div>
  <div class="row justify-content-center mb-4 mt-4">
    <div class="col-sm-6">
      <%= render 'user/shares/modal_form', record: @birth_record, button_classes: 'btn btn-primary btn-block' %>
    </div>
  </div>
</div>
<% if @shares.size.positive? %>
  <h4>Shared with</h4>
  <ul class="list-group list-group-flush">
    <%- @shares.each do |share| %>
      <li class="list-group-item">
        <div class=" d-flex justify-content-between ">
          <strong><%= share.recipient.name %></strong>
          <span class="share-buttons">
            <%= link_to 'Revoke', revoke_user_share_path(share),
            method: :post, class: 'btn btn-danger',
            data: { confirm: 'Are you sure?' }%>
          </span>
        </div>
        <ul class="list-unstyled">
          <% share.audits.sharing_birth_record.each do |audit| %>
            <li>Shared on <%= audit.created_at.in_time_zone('Pacific/Auckland').to_s(:short) %></li>
          <% end %>
          <% share.audits.viewing_birth_record.each do |audit| %>
            <li>Viewed on <%= audit.created_at.in_time_zone('Pacific/Auckland').to_s(:short) %> by <%= audit.user.email %></li>
          <% end %>
        </ul>
      </li>
    <% end %>
  </ul>
<% end %>
